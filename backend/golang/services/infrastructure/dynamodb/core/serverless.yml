service: mfh-infrastructure-dynamodb-core

frameworkVersion: '4'

provider:
  name: aws
  runtime: provided.al2023
  region: us-west-2
  stage: ${opt:stage, 'dev'}

resources:
  Resources:
    # Users Table
    UsersTable:
      Type: AWS::DynamoDB::Table
      DeletionPolicy: Retain
      Properties:
        TableName: mfh-${self:provider.stage}-users
        BillingMode: PAY_PER_REQUEST
        DeletionProtectionEnabled: true
        PointInTimeRecoverySpecification:
          PointInTimeRecoveryEnabled: true
        StreamSpecification:
          StreamViewType: NEW_AND_OLD_IMAGES
        AttributeDefinitions:
          - AttributeName: user_id
            AttributeType: S
          - AttributeName: email
            AttributeType: S
          - AttributeName: cognito_user_id
            AttributeType: S
        KeySchema:
          - AttributeName: user_id
            KeyType: HASH
        GlobalSecondaryIndexes:
          - IndexName: EmailIndex
            KeySchema:
              - AttributeName: email
                KeyType: HASH
            Projection:
              ProjectionType: ALL
          - IndexName: CognitoUserIdIndex
            KeySchema:
              - AttributeName: cognito_user_id
                KeyType: HASH
            Projection:
              ProjectionType: ALL

    # Accounts Table
    AccountsTable:
      Type: AWS::DynamoDB::Table
      DeletionPolicy: Retain
      Properties:
        TableName: mfh-${self:provider.stage}-accounts
        BillingMode: PAY_PER_REQUEST
        DeletionProtectionEnabled: true
        PointInTimeRecoverySpecification:
          PointInTimeRecoveryEnabled: true
        StreamSpecification:
          StreamViewType: NEW_AND_OLD_IMAGES
        AttributeDefinitions:
          - AttributeName: account_id
            AttributeType: S
          - AttributeName: owner_user_id
            AttributeType: S
          - AttributeName: stripe_customer_id
            AttributeType: S
        KeySchema:
          - AttributeName: account_id
            KeyType: HASH
        GlobalSecondaryIndexes:
          - IndexName: OwnerUserIdIndex
            KeySchema:
              - AttributeName: owner_user_id
                KeyType: HASH
            Projection:
              ProjectionType: ALL
          - IndexName: StripeCustomerIdIndex
            KeySchema:
              - AttributeName: stripe_customer_id
                KeyType: HASH
            Projection:
              ProjectionType: INCLUDE
              NonKeyAttributes:
                - owner_user_id
                - plan
                - status

    # User-Accounts Relationship Table
    UserAccountsTable:
      Type: AWS::DynamoDB::Table
      DeletionPolicy: Retain
      Properties:
        TableName: mfh-${self:provider.stage}-user-accounts
        BillingMode: PAY_PER_REQUEST
        DeletionProtectionEnabled: true
        PointInTimeRecoverySpecification:
          PointInTimeRecoveryEnabled: true
        AttributeDefinitions:
          - AttributeName: user_id
            AttributeType: S
          - AttributeName: account_id
            AttributeType: S
        KeySchema:
          - AttributeName: user_id
            KeyType: HASH
          - AttributeName: account_id
            KeyType: RANGE
        GlobalSecondaryIndexes:
          - IndexName: AccountIdIndex
            KeySchema:
              - AttributeName: account_id
                KeyType: HASH
            Projection:
              ProjectionType: ALL

    # API Keys Table
    ApiKeysTable:
      Type: AWS::DynamoDB::Table
      DeletionPolicy: Retain
      Properties:
        TableName: mfh-${self:provider.stage}-api-keys
        BillingMode: PAY_PER_REQUEST
        DeletionProtectionEnabled: true
        AttributeDefinitions:
          - AttributeName: key_id
            AttributeType: S
          - AttributeName: account_id
            AttributeType: S
          - AttributeName: key_hash
            AttributeType: S
        KeySchema:
          - AttributeName: key_id
            KeyType: HASH
        GlobalSecondaryIndexes:
          - IndexName: AccountIdIndex
            KeySchema:
              - AttributeName: account_id
                KeyType: HASH
            Projection:
              ProjectionType: ALL
          - IndexName: KeyHashIndex
            KeySchema:
              - AttributeName: key_hash
                KeyType: HASH
            Projection:
              ProjectionType: ALL

    # Platform Connections Table
    ConnectionsTable:
      Type: AWS::DynamoDB::Table
      DeletionPolicy: Retain
      Properties:
        TableName: mfh-${self:provider.stage}-connections
        BillingMode: PAY_PER_REQUEST
        DeletionProtectionEnabled: true
        AttributeDefinitions:
          - AttributeName: connection_id
            AttributeType: S
          - AttributeName: account_id
            AttributeType: S
        KeySchema:
          - AttributeName: connection_id
            KeyType: HASH
        GlobalSecondaryIndexes:
          - IndexName: AccountIdIndex
            KeySchema:
              - AttributeName: account_id
                KeyType: HASH
            Projection:
              ProjectionType: ALL

    # Helpers Table
    HelpersTable:
      Type: AWS::DynamoDB::Table
      DeletionPolicy: Retain
      Properties:
        TableName: mfh-${self:provider.stage}-helpers
        BillingMode: PAY_PER_REQUEST
        DeletionProtectionEnabled: true
        AttributeDefinitions:
          - AttributeName: helper_id
            AttributeType: S
          - AttributeName: account_id
            AttributeType: S
          - AttributeName: short_key
            AttributeType: S
        KeySchema:
          - AttributeName: helper_id
            KeyType: HASH
        GlobalSecondaryIndexes:
          - IndexName: AccountIdIndex
            KeySchema:
              - AttributeName: account_id
                KeyType: HASH
            Projection:
              ProjectionType: ALL
          - IndexName: ShortKeyIndex
            KeySchema:
              - AttributeName: short_key
                KeyType: HASH
            Projection:
              ProjectionType: ALL

    # Executions Table
    ExecutionsTable:
      Type: AWS::DynamoDB::Table
      DeletionPolicy: Retain
      Properties:
        TableName: mfh-${self:provider.stage}-executions
        BillingMode: PAY_PER_REQUEST
        DeletionProtectionEnabled: true
        StreamSpecification:
          StreamViewType: NEW_IMAGE
        TimeToLiveSpecification:
          AttributeName: ttl
          Enabled: true
        AttributeDefinitions:
          - AttributeName: execution_id
            AttributeType: S
          - AttributeName: account_id
            AttributeType: S
          - AttributeName: helper_id
            AttributeType: S
          - AttributeName: created_at
            AttributeType: S
        KeySchema:
          - AttributeName: execution_id
            KeyType: HASH
        GlobalSecondaryIndexes:
          - IndexName: AccountIdCreatedAtIndex
            KeySchema:
              - AttributeName: account_id
                KeyType: HASH
              - AttributeName: created_at
                KeyType: RANGE
            Projection:
              ProjectionType: ALL
          - IndexName: HelperIdCreatedAtIndex
            KeySchema:
              - AttributeName: helper_id
                KeyType: HASH
              - AttributeName: created_at
                KeyType: RANGE
            Projection:
              ProjectionType: ALL

    # Platforms Table (CRM platform definitions)
    PlatformsTable:
      Type: AWS::DynamoDB::Table
      DeletionPolicy: Retain
      Properties:
        TableName: mfh-${self:provider.stage}-platforms
        BillingMode: PAY_PER_REQUEST
        DeletionProtectionEnabled: true
        AttributeDefinitions:
          - AttributeName: platform_id
            AttributeType: S
          - AttributeName: slug
            AttributeType: S
        KeySchema:
          - AttributeName: platform_id
            KeyType: HASH
        GlobalSecondaryIndexes:
          - IndexName: SlugIndex
            KeySchema:
              - AttributeName: slug
                KeyType: HASH
            Projection:
              ProjectionType: ALL

    # Platform Connection Auth Table (credential separation)
    PlatformConnectionAuthsTable:
      Type: AWS::DynamoDB::Table
      DeletionPolicy: Retain
      Properties:
        TableName: mfh-${self:provider.stage}-platform-connection-auths
        BillingMode: PAY_PER_REQUEST
        DeletionProtectionEnabled: true
        AttributeDefinitions:
          - AttributeName: auth_id
            AttributeType: S
          - AttributeName: connection_id
            AttributeType: S
        KeySchema:
          - AttributeName: auth_id
            KeyType: HASH
        GlobalSecondaryIndexes:
          - IndexName: ConnectionIdIndex
            KeySchema:
              - AttributeName: connection_id
                KeyType: HASH
            Projection:
              ProjectionType: ALL

    # OAuth States Table (for CRM connections)
    OAuthStatesTable:
      Type: AWS::DynamoDB::Table
      Properties:
        TableName: mfh-${self:provider.stage}-oauth-states
        BillingMode: PAY_PER_REQUEST
        TimeToLiveSpecification:
          AttributeName: ttl
          Enabled: true
        AttributeDefinitions:
          - AttributeName: state
            AttributeType: S
        KeySchema:
          - AttributeName: state
            KeyType: HASH

    # Rate Limits Table (burst rate limiting with TTL auto-cleanup)
    RateLimitsTable:
      Type: AWS::DynamoDB::Table
      Properties:
        TableName: mfh-${self:provider.stage}-rate-limits
        BillingMode: PAY_PER_REQUEST
        TimeToLiveSpecification:
          AttributeName: ttl
          Enabled: true
        AttributeDefinitions:
          - AttributeName: key
            AttributeType: S
        KeySchema:
          - AttributeName: key
            KeyType: HASH

    # Countdown Timers Table (helper feature with TTL auto-cleanup)
    CountdownTimersTable:
      Type: AWS::DynamoDB::Table
      Properties:
        TableName: mfh-${self:provider.stage}-countdown-timers
        BillingMode: PAY_PER_REQUEST
        TimeToLiveSpecification:
          AttributeName: expires_at
          Enabled: true
        AttributeDefinitions:
          - AttributeName: timer_key
            AttributeType: S
        KeySchema:
          - AttributeName: timer_key
            KeyType: HASH

    # Email Validations Table (temporary validation codes with TTL auto-cleanup)
    EmailValidationsTable:
      Type: AWS::DynamoDB::Table
      Properties:
        TableName: mfh-${self:provider.stage}-email-validations
        BillingMode: PAY_PER_REQUEST
        TimeToLiveSpecification:
          AttributeName: expires_at
          Enabled: true
        AttributeDefinitions:
          - AttributeName: account_email
            AttributeType: S
        KeySchema:
          - AttributeName: account_email
            KeyType: HASH

    # Chat Conversations Table (MCP chat service)
    ChatConversationsTable:
      Type: AWS::DynamoDB::Table
      DeletionPolicy: Retain
      Properties:
        TableName: mfh-${self:provider.stage}-chat-conversations
        BillingMode: PAY_PER_REQUEST
        DeletionProtectionEnabled: true
        TimeToLiveSpecification:
          AttributeName: ttl
          Enabled: true
        AttributeDefinitions:
          - AttributeName: conversation_id
            AttributeType: S
          - AttributeName: account_id
            AttributeType: S
          - AttributeName: created_at
            AttributeType: S
        KeySchema:
          - AttributeName: conversation_id
            KeyType: HASH
        GlobalSecondaryIndexes:
          - IndexName: AccountIdIndex
            KeySchema:
              - AttributeName: account_id
                KeyType: HASH
              - AttributeName: created_at
                KeyType: RANGE
            Projection:
              ProjectionType: ALL

    # Chat Messages Table (MCP chat service)
    ChatMessagesTable:
      Type: AWS::DynamoDB::Table
      DeletionPolicy: Retain
      Properties:
        TableName: mfh-${self:provider.stage}-chat-messages
        BillingMode: PAY_PER_REQUEST
        DeletionProtectionEnabled: true
        AttributeDefinitions:
          - AttributeName: message_id
            AttributeType: S
          - AttributeName: conversation_id
            AttributeType: S
          - AttributeName: sequence
            AttributeType: N
        KeySchema:
          - AttributeName: message_id
            KeyType: HASH
        GlobalSecondaryIndexes:
          - IndexName: ConversationIdIndex
            KeySchema:
              - AttributeName: conversation_id
                KeyType: HASH
              - AttributeName: sequence
                KeyType: RANGE
            Projection:
              ProjectionType: ALL

    # Phone Mappings Table (SMS chat feature)
    PhoneMappingsTable:
      Type: AWS::DynamoDB::Table
      DeletionPolicy: Retain
      Properties:
        TableName: mfh-${self:provider.stage}-phone-mappings
        BillingMode: PAY_PER_REQUEST
        DeletionProtectionEnabled: true
        AttributeDefinitions:
          - AttributeName: phone_number
            AttributeType: S
        KeySchema:
          - AttributeName: phone_number
            KeyType: HASH

    # Email Logs Table (sent email history with TTL cleanup)
    EmailLogsTable:
      Type: AWS::DynamoDB::Table
      DeletionPolicy: Retain
      Properties:
        TableName: mfh-${self:provider.stage}-email-logs
        BillingMode: PAY_PER_REQUEST
        DeletionProtectionEnabled: true
        TimeToLiveSpecification:
          AttributeName: ttl
          Enabled: true
        AttributeDefinitions:
          - AttributeName: email_id
            AttributeType: S
          - AttributeName: account_id
            AttributeType: S
          - AttributeName: created_at
            AttributeType: S
          - AttributeName: recipient_email
            AttributeType: S
        KeySchema:
          - AttributeName: email_id
            KeyType: HASH
        GlobalSecondaryIndexes:
          - IndexName: AccountIdIndex
            KeySchema:
              - AttributeName: account_id
                KeyType: HASH
              - AttributeName: created_at
                KeyType: RANGE
            Projection:
              ProjectionType: ALL
          - IndexName: RecipientEmailIndex
            KeySchema:
              - AttributeName: recipient_email
                KeyType: HASH
              - AttributeName: created_at
                KeyType: RANGE
            Projection:
              ProjectionType: ALL

    # Email Templates Table (system and user templates)
    EmailTemplatesTable:
      Type: AWS::DynamoDB::Table
      DeletionPolicy: Retain
      Properties:
        TableName: mfh-${self:provider.stage}-email-templates
        BillingMode: PAY_PER_REQUEST
        DeletionProtectionEnabled: true
        AttributeDefinitions:
          - AttributeName: template_id
            AttributeType: S
          - AttributeName: account_id
            AttributeType: S
        KeySchema:
          - AttributeName: template_id
            KeyType: HASH
        GlobalSecondaryIndexes:
          - IndexName: AccountIdIndex
            KeySchema:
              - AttributeName: account_id
                KeyType: HASH
            Projection:
              ProjectionType: ALL

    # Sync Executions Table (chunked continuation state for data sync)
    SyncExecutionsTable:
      Type: AWS::DynamoDB::Table
      Properties:
        TableName: mfh-${self:provider.stage}-sync-executions
        BillingMode: PAY_PER_REQUEST
        TimeToLiveSpecification:
          AttributeName: ttl
          Enabled: true
        PointInTimeRecoverySpecification:
          PointInTimeRecoveryEnabled: true
        AttributeDefinitions:
          - AttributeName: execution_id
            AttributeType: S
          - AttributeName: status
            AttributeType: S
          - AttributeName: started_at
            AttributeType: S
        KeySchema:
          - AttributeName: execution_id
            KeyType: HASH
        GlobalSecondaryIndexes:
          - IndexName: StatusIndex
            KeySchema:
              - AttributeName: status
                KeyType: HASH
              - AttributeName: started_at
                KeyType: RANGE
            Projection:
              ProjectionType: ALL

    # Studio Dashboards Table (user-created dashboard configs with widgets)
    DashboardsTable:
      Type: AWS::DynamoDB::Table
      DeletionPolicy: Retain
      Properties:
        TableName: mfh-${self:provider.stage}-dashboards
        BillingMode: PAY_PER_REQUEST
        DeletionProtectionEnabled: true
        PointInTimeRecoverySpecification:
          PointInTimeRecoveryEnabled: true
        AttributeDefinitions:
          - AttributeName: dashboard_id
            AttributeType: S
          - AttributeName: account_id
            AttributeType: S
        KeySchema:
          - AttributeName: dashboard_id
            KeyType: HASH
        GlobalSecondaryIndexes:
          - IndexName: AccountIdIndex
            KeySchema:
              - AttributeName: account_id
                KeyType: HASH
            Projection:
              ProjectionType: ALL

    # Email Verifications Table (email verification tokens with TTL)
    EmailVerificationsTable:
      Type: AWS::DynamoDB::Table
      Properties:
        TableName: mfh-${self:provider.stage}-email-verifications
        BillingMode: PAY_PER_REQUEST
        TimeToLiveSpecification:
          AttributeName: expires_at
          Enabled: true
        AttributeDefinitions:
          - AttributeName: verification_id
            AttributeType: S
          - AttributeName: email
            AttributeType: S
        KeySchema:
          - AttributeName: verification_id
            KeyType: HASH
        GlobalSecondaryIndexes:
          - IndexName: EmailIndex
            KeySchema:
              - AttributeName: email
                KeyType: HASH
            Projection:
              ProjectionType: ALL

    # Webhook Events Table (Stripe webhook idempotency + audit trail)
    WebhookEventsTable:
      Type: AWS::DynamoDB::Table
      Properties:
        TableName: mfh-${self:provider.stage}-webhook-events
        BillingMode: PAY_PER_REQUEST
        StreamSpecification:
          StreamViewType: NEW_AND_OLD_IMAGES
        TimeToLiveSpecification:
          AttributeName: ttl
          Enabled: true
        AttributeDefinitions:
          - AttributeName: event_id
            AttributeType: S
        KeySchema:
          - AttributeName: event_id
            KeyType: HASH

  Outputs:
    UsersTableName:
      Value: !Ref UsersTable
      Export:
        Name: ${self:service}-${self:provider.stage}-UsersTableName
    UsersTableArn:
      Value: !GetAtt UsersTable.Arn
      Export:
        Name: ${self:service}-${self:provider.stage}-UsersTableArn
    UsersTableStreamArn:
      Value: !GetAtt UsersTable.StreamArn
      Export:
        Name: ${self:service}-${self:provider.stage}-UsersTableStreamArn

    AccountsTableName:
      Value: !Ref AccountsTable
      Export:
        Name: ${self:service}-${self:provider.stage}-AccountsTableName
    AccountsTableArn:
      Value: !GetAtt AccountsTable.Arn
      Export:
        Name: ${self:service}-${self:provider.stage}-AccountsTableArn
    AccountsTableStreamArn:
      Value: !GetAtt AccountsTable.StreamArn
      Export:
        Name: ${self:service}-${self:provider.stage}-AccountsTableStreamArn

    UserAccountsTableName:
      Value: !Ref UserAccountsTable
      Export:
        Name: ${self:service}-${self:provider.stage}-UserAccountsTableName
    UserAccountsTableArn:
      Value: !GetAtt UserAccountsTable.Arn
      Export:
        Name: ${self:service}-${self:provider.stage}-UserAccountsTableArn

    ApiKeysTableName:
      Value: !Ref ApiKeysTable
      Export:
        Name: ${self:service}-${self:provider.stage}-ApiKeysTableName
    ApiKeysTableArn:
      Value: !GetAtt ApiKeysTable.Arn
      Export:
        Name: ${self:service}-${self:provider.stage}-ApiKeysTableArn

    ConnectionsTableName:
      Value: !Ref ConnectionsTable
      Export:
        Name: ${self:service}-${self:provider.stage}-ConnectionsTableName
    ConnectionsTableArn:
      Value: !GetAtt ConnectionsTable.Arn
      Export:
        Name: ${self:service}-${self:provider.stage}-ConnectionsTableArn

    HelpersTableName:
      Value: !Ref HelpersTable
      Export:
        Name: ${self:service}-${self:provider.stage}-HelpersTableName
    HelpersTableArn:
      Value: !GetAtt HelpersTable.Arn
      Export:
        Name: ${self:service}-${self:provider.stage}-HelpersTableArn

    ExecutionsTableName:
      Value: !Ref ExecutionsTable
      Export:
        Name: ${self:service}-${self:provider.stage}-ExecutionsTableName
    ExecutionsTableArn:
      Value: !GetAtt ExecutionsTable.Arn
      Export:
        Name: ${self:service}-${self:provider.stage}-ExecutionsTableArn
    ExecutionsTableStreamArn:
      Value: !GetAtt ExecutionsTable.StreamArn
      Export:
        Name: ${self:service}-${self:provider.stage}-ExecutionsTableStreamArn

    PlatformsTableName:
      Value: !Ref PlatformsTable
      Export:
        Name: ${self:service}-${self:provider.stage}-PlatformsTableName
    PlatformsTableArn:
      Value: !GetAtt PlatformsTable.Arn
      Export:
        Name: ${self:service}-${self:provider.stage}-PlatformsTableArn

    PlatformConnectionAuthsTableName:
      Value: !Ref PlatformConnectionAuthsTable
      Export:
        Name: ${self:service}-${self:provider.stage}-PlatformConnectionAuthsTableName
    PlatformConnectionAuthsTableArn:
      Value: !GetAtt PlatformConnectionAuthsTable.Arn
      Export:
        Name: ${self:service}-${self:provider.stage}-PlatformConnectionAuthsTableArn

    OAuthStatesTableName:
      Value: !Ref OAuthStatesTable
      Export:
        Name: ${self:service}-${self:provider.stage}-OAuthStatesTableName
    OAuthStatesTableArn:
      Value: !GetAtt OAuthStatesTable.Arn
      Export:
        Name: ${self:service}-${self:provider.stage}-OAuthStatesTableArn

    RateLimitsTableName:
      Value: !Ref RateLimitsTable
      Export:
        Name: ${self:service}-${self:provider.stage}-RateLimitsTableName
    RateLimitsTableArn:
      Value: !GetAtt RateLimitsTable.Arn
      Export:
        Name: ${self:service}-${self:provider.stage}-RateLimitsTableArn

    CountdownTimersTableName:
      Value: !Ref CountdownTimersTable
      Export:
        Name: ${self:service}-${self:provider.stage}-CountdownTimersTableName
    CountdownTimersTableArn:
      Value: !GetAtt CountdownTimersTable.Arn
      Export:
        Name: ${self:service}-${self:provider.stage}-CountdownTimersTableArn

    EmailValidationsTableName:
      Value: !Ref EmailValidationsTable
      Export:
        Name: ${self:service}-${self:provider.stage}-EmailValidationsTableName
    EmailValidationsTableArn:
      Value: !GetAtt EmailValidationsTable.Arn
      Export:
        Name: ${self:service}-${self:provider.stage}-EmailValidationsTableArn

    ChatConversationsTableName:
      Value: !Ref ChatConversationsTable
      Export:
        Name: ${self:service}-${self:provider.stage}-ChatConversationsTableName
    ChatConversationsTableArn:
      Value: !GetAtt ChatConversationsTable.Arn
      Export:
        Name: ${self:service}-${self:provider.stage}-ChatConversationsTableArn

    ChatMessagesTableName:
      Value: !Ref ChatMessagesTable
      Export:
        Name: ${self:service}-${self:provider.stage}-ChatMessagesTableName
    ChatMessagesTableArn:
      Value: !GetAtt ChatMessagesTable.Arn
      Export:
        Name: ${self:service}-${self:provider.stage}-ChatMessagesTableArn

    PhoneMappingsTableName:
      Value: !Ref PhoneMappingsTable
      Export:
        Name: ${self:service}-${self:provider.stage}-PhoneMappingsTableName
    PhoneMappingsTableArn:
      Value: !GetAtt PhoneMappingsTable.Arn
      Export:
        Name: ${self:service}-${self:provider.stage}-PhoneMappingsTableArn

    EmailLogsTableName:
      Value: !Ref EmailLogsTable
      Export:
        Name: ${self:service}-${self:provider.stage}-EmailLogsTableName
    EmailLogsTableArn:
      Value: !GetAtt EmailLogsTable.Arn
      Export:
        Name: ${self:service}-${self:provider.stage}-EmailLogsTableArn

    EmailTemplatesTableName:
      Value: !Ref EmailTemplatesTable
      Export:
        Name: ${self:service}-${self:provider.stage}-EmailTemplatesTableName
    EmailTemplatesTableArn:
      Value: !GetAtt EmailTemplatesTable.Arn
      Export:
        Name: ${self:service}-${self:provider.stage}-EmailTemplatesTableArn

    EmailVerificationsTableName:
      Value: !Ref EmailVerificationsTable
      Export:
        Name: ${self:service}-${self:provider.stage}-EmailVerificationsTableName
    EmailVerificationsTableArn:
      Value: !GetAtt EmailVerificationsTable.Arn
      Export:
        Name: ${self:service}-${self:provider.stage}-EmailVerificationsTableArn

    SyncExecutionsTableName:
      Value: !Ref SyncExecutionsTable
      Export:
        Name: ${self:service}-${self:provider.stage}-SyncExecutionsTableName
    SyncExecutionsTableArn:
      Value: !GetAtt SyncExecutionsTable.Arn
      Export:
        Name: ${self:service}-${self:provider.stage}-SyncExecutionsTableArn

    DashboardsTableName:
      Value: !Ref DashboardsTable
      Export:
        Name: ${self:service}-${self:provider.stage}-DashboardsTableName
    DashboardsTableArn:
      Value: !GetAtt DashboardsTable.Arn
      Export:
        Name: ${self:service}-${self:provider.stage}-DashboardsTableArn

    WebhookEventsTableName:
      Value: !Ref WebhookEventsTable
      Export:
        Name: ${self:service}-${self:provider.stage}-WebhookEventsTableName
    WebhookEventsTableArn:
      Value: !GetAtt WebhookEventsTable.Arn
      Export:
        Name: ${self:service}-${self:provider.stage}-WebhookEventsTableArn
    WebhookEventsTableStreamArn:
      Value: !GetAtt WebhookEventsTable.StreamArn
      Export:
        Name: ${self:service}-${self:provider.stage}-WebhookEventsTableStreamArn
